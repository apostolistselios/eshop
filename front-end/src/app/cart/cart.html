<h4>Your cart</h4>

@if (isLoading()) {
  <p class="text-muted">Loading cart...</p>
} @else if (items().length === 0) {
  <p class="text-muted">Your cart is empty.</p>
} @else {
  <div class="row g-3">
    <div class="col-12 col-lg-8">
      <p-table [value]="items()" size="small">
        <ng-template pTemplate="header">
          <tr>
            <th>Product</th>
            <th>Unit price</th>
            <th>Quantity</th>
            <th>Total</th>
            <th></th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-item>
          <tr>
            <td>{{ item.productType }} - {{ item.productBrand }}</td>
            <td>$ {{ item.unitPrice }}</td>
            <td>
              <p-inputNumber
                [(ngModel)]="quantities[item.productId]"
                [min]="0"
                [useGrouping]="false"
                size="small"
                inputId="quantity-{{ item.productId }}"
              />
            </td>
            <td>$ {{ item.totalPrice }}</td>
            <td class="text-end">
              <div class="d-flex justify-content-end gap-2">
                <p-button
                  label="Update"
                  size="small"
                  [disabled]="isUpdating(item.productId)"
                  (onClick)="updateItem(item)"
                />
                <p-button
                  icon="pi pi-trash"
                  severity="danger"
                  size="small"
                  [disabled]="isUpdating(item.productId)"
                  (onClick)="removeItem(item)"
                />
              </div>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </div>
    <div class="col-12 col-lg-4">
      <p-card header="Summary">
        <div class="d-flex justify-content-between align-items-center">
          <span>Total</span>
          <span class="fw-bold">$ {{ totalAmount() }}</span>
        </div>
        <div class="d-flex justify-content-end mt-3">
          <p-button label="Checkout" [disabled]="isCheckingOut()" (onClick)="checkout()" />
        </div>
      </p-card>
    </div>
  </div>
}
